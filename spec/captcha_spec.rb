require "spec_helper"

describe "captcha check" do

  let (:captcha)do
    CaptchaImage.new(
        {
            :headers => {"Set-Cookie" => "ASP.NET_SessionId=d3gm2vmakqddgu45zeetfojw; path=/; HttpOnly"}
        })
  end

  xit "should return aec cookies" do


    captcha.cookies.should == {}

  end

  context "random data url generation" do
    before :each do
      Random.any_instance.stub(:rand).and_return( 0.5 )
    end
    xit "should produce two identical images" do

      puts captcha.data_uri
      puts captcha.cookies

      captcha.data_uri.should == "data:image/jpeg;base64,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"
      captcha.cookies.should include("ASP.NET_SessionId=d3gm2vmakqddgu45zeetfojw; path=/; HttpOnly")
    end
  end



end